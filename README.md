# Утилита фильтрации содержимого файлов.

Исходный текст задания доступен [здесь](TASK.md)

Утилита сортирует содержимое файлов, поданных на вход, в зависимости от их типа, и распределяет по выходным файлам.
Входных файлов может быть сколько угодно. Из них берутся строчки, и распределяются
по категориям "целые числа", "строки" и "вещественные числа".

Опция -o задает путь для выходных файлов с результатами.
Выходные файлы по умолчанию называются integers.txt, floats.txt, strings.txt

Опция -p задает префикс имен выходных файлов.

Выбор статистики производится опциями -s и -f соответственно.
Краткая статистика содержит только количество элементов записанных в исходящие файлы.
Полная статистика для чисел дополнительно содержит минимальное и максимальное значения, сумма и среднее.
Полная статистика для строк, помимо их количества, содержит также размер самой короткой строки и самой длинной.

## Запуск ##

Для запуска используется команда вида
```bash
java -jar build/libs/util.jar [опции] <входной_файл1> <входной_файл2> ...
```

Опции командной строки

| Опция | Описание                                            | Значение по умолчанию |
|:---|:----------------------------------------------------|:---|
| `-p` | Задает префикс для имен выходных файлов.            |  |
| `-o` | Указывает директорию для сохранения результатов.    | Текущая директория |
| `-a` | Включает режим добавления в существующие файлы.     | Режим перезаписи |
| `-s` | Вывести краткую статистику (только количество).     |  |
| `-f` | Вывести полную статистику (min/max, сумма, средне). |  |

## Требования ##
JDK >= 17

## Компиляция ##

Используется система сборки Gradle.

Вместе с проектом идет версия 8.14.3, для совместимости с последней JDK 24. Она также совместима с JDK 17 и 21

Для переключения на более раннее версии, можно использовать команду
```bash
./gradlew wrapper --gradle-version <версия> 
```

Для компиляции используется команда

```bash
./gradlew build 
```

или
```bash
gradlew.bat build
```
для Windows.

Исполняемый файл `util.jar` будет находиться в директории `build/libs/`

## Сторонние библиотеки и детали реализации ##

Для облегчения обработки аргументов командной строки использовалась библиотека picocli версии 4.7.7

Библиотека позволяет декларативно описывать опции, автоматически генерирует справку и обрабатывает ошибки ввода.

```kotlin
val picocliVersion = "4.7.7"
implementation("info.picocli:picocli:$picocliVersion")
annotationProcessor("info.picocli:picocli-codegen:$picocliVersion")
```

Она включена в итоговый util.jar

Была использована рекомендуемая в документации Picocli конфигурация с основной "вызывающей" логикой в метод call()

[Ссылка на библиотеку](https://picocli.info/)

### Данные ###

Для подсчета суммы чисел используется BigDecimal, так как числа могут быть очень большими

Специальные значения NaN, Infinity, -Infinity, +Infinity классифицируются как строки.

Начальные и конечные пробелы в строках игнорируются при классификации чисел, число ` 123 ` будет считаться `123`

### Обработка ошибок: ###
Фатальные ошибки конфигурации (неверный префикс, отсутствие прав на запись в выходную директорию) прерывают выполнение программы.

Локальные ошибки данных (Один из входных файлов не существует или является директорией, сбой чтения и так далее), не мешают работе программы, согласно заданию.


## Тестирование ##
Программа частично покрыта модульными тестами с использованием JUnit 5, все они успешно пройдены.

Написаны интеграционные тесты, проверяющие работу собранной утилиты на реальных файлах.

Для дополнительного тестирования на производительность использовалась [самостоятельно написанная утилита](https://github.com/developer-d723/bigTextGenerator),
позволяющая создавать необходимые текстовые файлы произвольного размера.